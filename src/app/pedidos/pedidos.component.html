<div class="row">
  <div class="col-sm-2 col-xs-2">
      &nbsp;
  </div>
</div>
<div class="row">
  <div class="col-sm-2 col-xs-2">
      &nbsp;
  </div>
</div>
<div class="row">
  <div class="col-sm-2 col-xs-2">
      &nbsp;
  </div>
</div>
<div class="row">
  <div class="col-sm-2 col-xs-2">
      &nbsp;
  </div>
</div>
<div class="row">
  <div class="col-sm-2 col-xs-2">&nbsp;</div>
  <div class="col-sm-8 col-xs-8 badge badge-primary"> <h5><img src="/assets/imagens/icons/clientes.png" class="mr-2" style="width: 30px"> Cadastro de Clientes</h5></div>
</div>
<div class="row">
  <div class="col-sm-2 col-xs-2">
      &nbsp;
  </div>

  <div class="col-sm-8 col-xs-8 border border-primary rounded shadow-lg p-4 mb-4 bg-white">
      <h4>Dados do Cliente</h4>
      <form [formGroup]="pedidoForm" novalidate>
          <div class="row">
              <div class="col-sm-2 col-xs-2">
                  &nbsp;
              </div>
          </div>
          <div class="row">
              <div class="col-sm-2 col-xs-2">
                  &nbsp;
              </div>
              <div class="col-sm-2 col-xs-2">
                      Nº Pedido:
              </div>
              <div class="col-sm-6  col-xs-6">
                <input name="Id_Ped" class="form-control" formControlName="Id_Ped" autocomplete="off" [attr.disabled]="true"  placeholder="Nº Pedido">
              </div>
          </div>
          <div class="row">
            <div class="col-sm-2 col-xs-2">
                &nbsp;
            </div>
          </div>
          <div class="row">
            <div class="col-sm-2 col-xs-2">
              &nbsp;
            </div>
            <div class="col-sm-2 col-xs-2">
                    {{labelCpfCliente}}
            </div>
            <div class="col-sm-6  col-xs-6">
              <cft-input errorMessage="Campo obrigatório com maximo de 18 caracteres" label="Cliente">
                <input name="Nome_Cli" class="form-control" formControlName="Nome_Cli" autocomplete="off" placeholder="Digite CPF/CNPF" [attr.disabled]="strDesabilitaCliente">
              </cft-input>
            </div>
            <div class="col-xs-12 col-sm-2" >
              <span *ngIf="pedidoForm.get('Nome_Cli').getError('clienteNotValid')" style="color:red">
                <i class="fa fa-remove"></i> O CPF/CNPJ não é válido.
              </span>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-2 col-xs-2">
              &nbsp;
            </div>
            <div class="col-sm-2 col-xs-2">
                    {{labelCliente}}
            </div>
            <div class="col-sm-6  col-xs-6">
              {{cliente}}
            </div>
          </div>
          <div class="row">
            <div class="col-sm-2 col-xs-2">
              &nbsp;
            </div>
          </div>
          <div class="row">
            <div class="col-sm-2 col-xs-2">
                &nbsp;
            </div>
            <div class="col-sm-2 col-xs-2">
                    Versão:
            </div>
            <div class="col-sm-6  col-xs-6">
                <input name="Versao" class="form-control" formControlName="Versao" autocomplete="off" placeholder="Versão" [attr.disabled]="true">
            </div>
          </div>
          <div class="row">
            <div class="col-sm-2 col-xs-2">
                &nbsp;
            </div>
          </div>
          <div class="row">
            <div class="col-sm-2 col-xs-2">
                &nbsp;
            </div>
            <div class="col-sm-2 col-xs-2">
                    Data:
            </div>
            <div class="col-sm-6  col-xs-6">
                <input name="DtPed" class="form-control" formControlName="DtPed" autocomplete="off" placeholder="Data Pedido" [attr.disabled]="true">
            </div>

          </div>
          <div>
            <div class="row">
              <div class="col-sm-2 col-xs-2">
                  &nbsp;
              </div>
            </div>
            <div>
              <div class="row">
                <div class="col-sm-2 col-xs-2">
                    &nbsp;
                </div>
                <div class="col-sm-2 col-xs-2">
                        Observação:
                </div>
                <div class="col-sm-6  col-xs-6">
                    <textarea class="form-control" name="Observ" rows="4" cols="50" formControlName="Observ" [attr.disabled]="blnDesabilitaCampos"></textarea>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-2 col-xs-2">
                    &nbsp;
                </div>
              </div>
              <div class="row">
                <div class="col-sm-2 col-xs-2">
                    &nbsp;
                </div>
                <div class="col-sm-2 col-xs-2">
                        Situação:
                </div>
                <div class="col-sm-6  col-xs-6">
                    <input name="DescrSituacao" class="form-control" formControlName="DescrSituacao" autocomplete="off" placeholder="Situação" [attr.disabled]="true">
                </div>
              </div>
              <div class="row">
                <div class="col-sm-2 col-xs-2">
                    &nbsp;
                </div>
              </div>
              <div class="row">
                <div class="col-sm-2 col-xs-2">
                    &nbsp;
                </div>
                <div class="col-sm-2 col-xs-2">
                        Ent.Min.:
                </div>
                <div class="col-sm-6  col-xs-6">
                  <input name="EntMin" class="form-control"  autocomplete="off" placeholder="Ent.Min" [attr.disabled]="true" value="{{data}}">
                </div>
              </div>
              <div class="row">
                <div class="col-sm-2 col-xs-2">
                    &nbsp;
                </div>
              </div>
              <div class="row">
                  <div class="col-sm-2 col-xs-2">
                      &nbsp;
                  </div>
                  <div class="col-sm-2 col-xs-2">
                      Entrega:
                  </div>
                  <div class="col-sm-6  col-xs-6">
                    <div class="row">
                      <div class="col-sm-10  col-xs-10" >
                        <cft-input errorMessage="" label="Observação">
                          <input  class="form-control" placeholder="dd/mm/yyyy" name="Entrega" ngbDatepicker #d1="ngbDatepicker" formControlName="Entrega" [minDate]="dataMin" [readonly]="true">
                          <!-- <input  name="Entrega" class="form-control" formControlName="Entrega" autocomplete="off" placeholder="dd/mm/aaaa"> -->
                        </cft-input>
                      </div>
                      <div class="col-sm-2  col-xs-2" >
                          <button class="btn btn-primary" (click)="d1.toggle()" type="button" [attr.disabled]="blnDesabilitaCampos"><i class="fa fa-table " ></i></button>
                      </div>
                      <div class="col-xs-12 col-sm-12" >
                        <span *ngIf="pedidoForm.get('Entrega').getError('dataEntrega')" style="color:red">
                          <i class="fa fa-remove"></i> Data não pode ser menor que a data de hoje.
                        </span>
                      </div>
                    </div>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-2 col-xs-2">
                    &nbsp;
                </div>
              </div>
              <div class="row">
                <div class="col-sm-2 col-xs-2">
                    &nbsp;
                </div>
                <div class="col-sm-2 col-xs-2">
                    Periodo:
                </div>
                <div class="col-sm-6  col-xs-6">
                    <select name="IdPeriodo" class="form-control" formControlName="Per_Ent" [value]="4" [attr.disabled]="blnDesabilitaCampos">
                      <option *ngFor=  "let c of (periodo)" [value]="c.IdPeriodo">{{c.Descricao}}</option>
                    </select>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-2 col-xs-2">
                    &nbsp;
                </div>
              </div>
              <div class="row">
                <div class="col-sm-2 col-xs-2">
                    &nbsp;
                </div>
                <div class="col-sm-2 col-xs-2">
                    Midia:
                </div>
                <div class="col-sm-6  col-xs-6">
                  <select name="IdMidia" class="form-control" formControlName="IdMidia" #IdMidia [attr.disabled]="blnDesabilitaCampos">
                    <option *ngFor=  "let c of (midias)" [value]="c.IdMidia">{{c.DescMidia}}</option>
                  </select>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-2 col-xs-2">
                    &nbsp;
                </div>
              </div>
              <div class="row">
                <div class="col-sm-2 col-xs-2">
                    &nbsp;
                </div>
                <div class="col-sm-2 col-xs-2">
                    Outras:
                </div>
                <div class="col-sm-6  col-xs-6">
                  <cft-input errorMessage="Campo obrigatório com maximo de 60 caracteres" label="Midia" >
                      <input name="DescMidia" class="form-control" formControlName="DescMidia" autocomplete="off" placeholder="Midia" [attr.disabled]="blnDesabilitaCampos">
                  </cft-input>
                </div>
                <div class="col-xs-12 col-sm-2" >
                  <span *ngIf="pedidoForm.hasError('midia')" style="color:red">
                    <i class="fa fa-remove"></i> Com a opção Outras na midia este campo deve ser preechido".
                  </span>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-2 col-xs-2">
                    &nbsp;
                </div>
                <div class="col-sm-2 col-xs-2">
                    Vendedores:
                </div>
                <div class="col-sm-6  col-xs-6">
                  <select name="IdVendedor" class="form-control" formControlName="IdVendedor" [attr.disabled]="blnDesabilitaCampos">
                    <option *ngFor=  "let c of (vendedores)" [value]="c.IdVendedor">{{c.Nome}}</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-2 col-xs-2">
                  &nbsp;
              </div>
            </div>
            <div class="row">
              <div class="col-sm-2 col-xs-2">
                  &nbsp;
              </div>
              <div class="col-sm-8 col-xs-8">
                  <button (click)="SalvarPedido(pedidoForm.value)"type="button" class="btn btn-primary pull-right btn-block" [disabled]="!pedidoForm.valid" >
                      <i class="fa fa-save"></i> Salvar
                  </button>
              </div>
              <div class="col-sm-8 col-xs-8">
                <button (click)="findInvalidControls()"type="button" class="btn btn-primary pull-right btn-block" >
                    <i class="fa fa-save"></i> teste
                </button>
              </div>
          </div>
            <div class="row">
              <div class="col-sm-2 col-xs-2">
                  &nbsp;
              </div>
            </div>
            <tabset>
              <tab heading="Produtos" id="tab1">
                <div class="row" style="border: 1px;">
                  <div class="col-sm-12 col-xs-12 table-responsive-xl">
                    <table class="table table-striped col-sm-12 col-xs-12">
                      <thead>
                      <tr>
                        <th>Produto</th>
                        <th>Quant.</th>
                        <th>Vl.Unit.</th>
                        <th>Vl.Total</th>
                        <th>Saída</th>
                        <th>Frete</th>
                        <th scope="col">Ação</th>
                        <th scope="col">Ação</th>
                      </tr>
                      </thead>
                      <tbody>
                      <tr *ngFor="let ip of itensPedido ">
                        <td>
                          <span [tooltip]="ip.Produto" placement="top" show-delay="500">
                            {{ip.Produto != null ? ip.Produto.substring(0,60) : null}}
                          </span>
                        </td>
                        <td>
                          <span [tooltip]="ip.Quantid" placement="top" show-delay="500">
                            {{ip.Quantid}}
                          </span>
                        </td>
                        <td>
                          <span [tooltip]="ip.Valuni" placement="top" show-delay="500">
                            {{ip.Valuni | currency : 'R$'}}
                          </span>
                        </td>
                        <td>
                          <span [tooltip]="ip.Valtot" placement="top" show-delay="500">
                            {{ip.Valtot | currency : 'R$'}}
                          </span>
                        </td>
                        <td>
                          <span [tooltip]="ip.Saida" placement="top" show-delay="500">
                            {{ip.Saida}}
                          </span>
                        </td>
                        <td>
                          <span [tooltip]="ip.TipoFrete" placement="top" show-delay="500">
                            {{ip.TipoFrete}}
                          </span>
                        </td>
                        <td><a class="nav-link linkPoint"  (click)="showChildModal(ip)">
                          <span tooltip="Editar" placement="top" show-delay="500">
                              <i class="fa fa-edit"></i>
                            </span>
                            </a>
                        </td>
                        <td>
                          <a class="nav-link linkPoint" (click)="ExcluirItemPedido(ip);"  >
                          <span tooltip="Excluir" placement="top" show-delay="500">
                            <img src="/assets/imagens/icons/excluir.png" class="mr-2" style="width: 20px">
                            </span>
                            </a>
                        </td>

                      </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-2 col-xs-2">
                      &nbsp;
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-3 col-xs-3">
                    <button class="btn btn-primary pull-right btn-block" data-toggle="modal" data-target="#Fabrica" type="button" [disabled]="blnDesabilitaBotoes">
                      <img src="assets/imagens/icons/factory2.png" class="mr-2" style="width: 20px; color: white; ">
                      Fábrica
                  </button>
                  </div>
                  <div class="col-sm-1 col-xs-1"></div>
                  <div class="col-sm-3 col-xs-3">
                    <button class="btn btn-primary pull-right btn-block" data-toggle="modal" data-target="#Estoque" type="button" data-backdrop="static" data-keyboard="false" data-dismiss = "modal" data-whatever="@mdo" [disabled]="blnDesabilitaBotoes">
                      <img src="assets/imagens/icons/estoque.png" class="mr-2" style="width: 20px; color: white; ">
                      Estoque
                    </button>
                  </div>
                  <div class="col-sm-1 col-xs-1"></div>
                  <div class="col-sm-3 col-xs-3">
                    <button class="btn btn-primary pull-right btn-block" data-toggle="modal" data-target="#Fabrica" type="button" [disabled]="blnDesabilitaBotoes">
                      <img src="assets/imagens/icons/atualizar.png" class="mr-2" style="width: 15px; color: white; ">
                      Atualizar
                    </button>
                  </div>
                </div>
              </tab>
              <tab heading="Financeiro">Basic content 1</tab>
              <tab heading="Entrega/Encerramento">Basic content 2</tab>
            </tabset>
          </div>
      </form>
      <div class="dx-fieldset">
        <!-- <dx-validation-summary id="summary"></dx-validation-summary> -->

      </div>
  </div>
</div>

<div class="modal" id="Estoque">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Itens de Estoque</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body ">
        <div class="row">
          <div class="col-sm-12 col-xs-12 ">
            Inserir Itens de Estoque do pedido {{nNumeroIped}}
          </div>
        </div>
        <div class="row">
          <div class="col-sm-1 col-xs-1 ">
            &nbsp;
          </div>
        </div>
        <div class="row">
          <div class="col-sm-1 col-xs-1 ">
            &nbsp;
          </div>
          <div class="col-sm-1 col-xs-1 ">
            Pal.Chave:
          </div>
          <div class="col-sm-4 col-xs-4 ">
            <input #palavraChave name="palavraChave" class="form-control"  autocomplete="off" placeholder="Palavra Chave" (input)="AtribuiValor(palavraChave.value)">
          </div>
          <div class="col-sm-1 col-xs-1 ">
            &nbsp;
          </div>
          <div class="col-sm-3 col-xs-3 ">
            <button class="btn btn-primary pull-right btn-block" type="button" [disabled]="!blnCriterio"
            (click)="ConsultarItensEstoque(Id_Alm,palavraChave)">
              <img src="assets/imagens/icons/pesquisa2.png" class="mr-2" style="width: 20px; color: white; ">
              Pesquisar
            </button>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-1 col-xs-1 ">
            &nbsp;
          </div>
        </div>
        <div class="row">
          <div class="col-sm-1 col-xs-1 ">
            &nbsp;
          </div>
          <div class="col-sm-1 col-xs-1 ">
            Estoque:
          </div>
          <div class="col-sm-4 col-xs-4 ">
            <select #Id_Alm name="Id_Alm" class="form-control"  >
              <option *ngFor=  "let c of (estoques)" [value]="c.Id_Alm">{{c.Descr}}</option>
            </select>
          </div>
          <div class="col-sm-1 col-xs-1 ">
            &nbsp;
          </div>
          <div class="col-sm-3 col-xs-3 ">
            <input name="qtdItens" class="form-control"  autocomplete="off" placeholder="Qtd Itens" [value]="qtdItensPesquisa">
          </div>
        </div>
        <div class="row">
          <div class="col-sm-1 col-xs-1 ">
            &nbsp;
          </div>
        </div>
        <div class="row" style="height: 200px; overflow-y: scroll;">
            <div class="col-sm-12 col-xs-12 ">
              <table class="table table-striped col-sm-12 col-xs-12">
                <thead>
                <tr>
                    <th scope="col" >Produto</th>
                    <th scope="col" >Quant.</th>
                    <th scope="col" >Preço</th>
                    <th scope="col" >Qtd.Pedido</th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let itens of itensEstoque">
                    <td>
                      <span class="tooltip-test" [title]="itens.Produto">{{itens.Produto.substring(0,30)}}</span>
                    </td>
                    <td>
                      {{itens.Quantidade}}
                    </td>
                    <td>
                      {{itens.Preco | currency : 'R$'}}
                    </td>
                    <td>
                      <a (click)="emitDecreaseQty(itens)" class="btn btn-sm"><i class="fa fa-minus"></i></a>
                          {{itens.QtdPedido}}
                      <a (click)="emitIncreaseQty(itens)" class="btn btn-sm"><i class="fa fa-plus"></i></a>
                    </td>
                </tr>
                </tbody>
              </table>
            </div>
        </div>

      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <div class="row">
          <div class="col-sm-6 col-xs-6 ">
            <button class="btn btn-primary pull-right btn-block" type="button" (click)="SalvarItensEstoque(itensEstoque)" [disabled]="!blnHabilitaInserirItensEstqoue" data-dismiss="modal">
              Inserir
            </button>
          </div>
          <div class="col-sm-6 col-xs-6 ">
            <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div bsModal #childModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title pull-left">Alteração de Item de Pedido</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="hideChildModal()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <!-- Modal body -->
      <div class="modal-body ">
        <div class="row">
          <div class="col-sm-2 col-xs-2 ">
            Produto:
          </div>
          <div class="col-sm-8 col-xs-8 ">
            {{itensPedido == null ? "" : itensPedidoAlteracao.Produto }}
          </div>
        </div>
        <div class="row">
          <div class="col-sm-1 col-xs-1 ">
            &nbsp;
          </div>
        </div>
        <div class="row">
          <div class="col-sm-2 col-xs-2 ">
            Quantidade:
          </div>
          <div class="col-sm-3 col-xs-3 ">
            <input name="Quantid" class="form-control" placeholder="Nº Pedido" [value]="itensPedido == null ? '' : itensPedidoAlteracao.Quantid">
          </div>
          <div class="col-sm-1 col-xs-1 ">
              Frete:
          </div>
          <div class="col-sm-5 col-xs-5 ">
            <div class="row ">
              <div class="form-check col-sm-4 col-xs-4">
                <input type="radio" class="form-check-input" name="tipoFrete" [checked]="itensPedido == null ? '' : itensPedidoAlteracao.TipoFrete == 'CLIENTE' ? true : false " > cliente
              </div>
              <div class="form-check col-sm-4 col-xs-4">
                <input type="radio" class="form-check-input" name="tipoFrete"  [checked]="itensPedido == null ? '' : itensPedidoAlteracao.TipoFrete == 'FÁBRICA' ? true : false " > fábrica
              </div>
              <!-- <div class="form-check disabled"> -->
              <div class="form-check disabled">
                <input type="radio" class="form-check-input" name="tipoFrete" [checked]="itensPedido == null ? '' : itensPedidoAlteracao.TipoFrete == 'TERCEIROS' ? true : false " > terceiros
              </div>
              <!-- <div class=" "><input type="radio" [checked]="itensPedido == null ? '' : itensPedidoAlteracao.TipoFrete == 'CLIENTE' ? true : false " > cliente</div>
              <div class="col-sm-4 col-xs-4 "><input type="radio" [checked]="itensPedido == null ? '' : itensPedidoAlteracao.TipoFrete == 'FÁBRICA' ? true : false " > fabrica</div>
              <div class="col-sm-4 col-xs-4 "><input type="radio" [checked]="itensPedido == null ? '' : itensPedidoAlteracao.TipoFrete == '' ? true : false " > terceiros</div> -->
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-1 col-xs-1 ">
            &nbsp;
          </div>
        </div>
        <div class="row">
          <div class="col-sm-2 col-xs-2 ">
            Vl. Tabela:
          </div>
          <div class="col-sm-3 col-xs-3 ">
            <input name="Quantid" class="form-control" placeholder="Nº Pedido" [value]="itensPedido == null ? '' :itensPedidoAlteracao.Quantid">
          </div>
          <div class="col-sm-2 col-xs-2 ">
              Desconto(%):
          </div>
          <div class="col-sm-4 col-xs-4 ">
            <input name="Quantid" class="form-control" placeholder="Nº Pedido" [value]="itensPedido == null ? '' :itensPedidoAlteracao.Quantid ">
          </div>
        </div>
        <div class="row">
          <div class="col-sm-1 col-xs-1 ">
            &nbsp;
          </div>
        </div>
        <div class="row">
          <div class="col-sm-2 col-xs-2 ">
            Unitário:
          </div>
          <div class="col-sm-3 col-xs-3 ">
            <input name="Quantid" class="form-control" placeholder="Nº Pedido" [value]="itensPedido == null ? '' :itensPedidoAlteracao.Valuni | currency : 'R$'">
          </div>
          <div class="col-sm-2 col-xs-2 ">
              Vl. Total:
          </div>
          <div class="col-sm-4 col-xs-4 ">
            <input name="Quantid" class="form-control" placeholder="Nº Pedido" [value]="itensPedido == null ? '' :itensPedidoAlteracao.Valtot | currency : 'R$'">
          </div>
        </div>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <div class="row">
          <div class="col-sm-6 col-xs-6 ">
            <button class="btn btn-primary pull-right btn-block" type="button" (click)="SalvarItensEstoque(itensEstoque)" [disabled]="!blnHabilitaInserirItensEstqoue" data-dismiss="modal">
              Inserir
            </button>
          </div>
          <div class="col-sm-6 col-xs-6 ">
            <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="hideChildModal()">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

